# 唯一索引和普通索引的选择

## 1. 什么是唯一索引

- 不具有相同索引值

- insert和update时，会做重复键值的检查

## 2. 什么是普通索引

- 最基本的索引，没有限制

## 3. 当有一个值是业务唯一时，应该创建唯一索引还是普通索引

### 1. 查找时，唯一索引快

- 唯一索引：查找到符合要求的记录后直接返回

- 普通索引：会比唯一索引多查找一次

### 2. insert/update时，唯一索引慢

- 唯一索引：由于必须验证唯一性，因此每次insert/update时，都会从文件将数据加载到内存，进行重复简直检查，这样会导致change buffer失效，insert/update存在I/O操作，性能下降

- 普通索引：不需要做验证，可以直接使用[change buffer](插入缓冲的介绍.md)失效

### 3. 总结

1. 如果是写完马上读的场景，建议使用唯一索引，因为读操作会将数据从文件读到内存，此时如果是普通索引，会产生一次merge操作，相当于既要维护change buffer，也需要从文件读，产生随机I/O操作，那么不如直接使用唯一索引

2. 如果是写多读少的场景，建议创建普通索引，因为change buffer减少了一次随机I/O操作，大大的提升了性能，此时数据的正确性需要由业务层控制，避免产生脏数据

> 注意

    如果写入非常密集，使用普通索引也会占用过多的缓冲池内存
